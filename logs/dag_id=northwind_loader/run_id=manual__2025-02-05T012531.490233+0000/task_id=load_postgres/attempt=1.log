[2025-02-05T01:25:32.322+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-02-05T01:25:32.337+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: northwind_loader.load_postgres manual__2025-02-05T01:25:31.490233+00:00 [queued]>
[2025-02-05T01:25:32.343+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: northwind_loader.load_postgres manual__2025-02-05T01:25:31.490233+00:00 [queued]>
[2025-02-05T01:25:32.344+0000] {taskinstance.py:2866} INFO - Starting attempt 1 of 1
[2025-02-05T01:25:32.355+0000] {taskinstance.py:2889} INFO - Executing <Task(DockerOperator): load_postgres> on 2025-02-05 01:25:31.490233+00:00
[2025-02-05T01:25:32.362+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70 DeprecationWarning: This process (pid=10917) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-02-05T01:25:32.362+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'northwind_loader', 'load_postgres', 'manual__2025-02-05T01:25:31.490233+00:00', '--job-id', '64', '--raw', '--subdir', 'DAGS_FOLDER/northwind_etl/northwind_loader_mel.py', '--cfg-path', '/tmp/tmpy8jbzpqt']
[2025-02-05T01:25:32.363+0000] {standard_task_runner.py:72} INFO - Started process 10918 to run task
[2025-02-05T01:25:32.363+0000] {standard_task_runner.py:105} INFO - Job 64: Subtask load_postgres
[2025-02-05T01:25:32.397+0000] {task_command.py:467} INFO - Running <TaskInstance: northwind_loader.load_postgres manual__2025-02-05T01:25:31.490233+00:00 [running]> on host 09d05643d017
[2025-02-05T01:25:32.464+0000] {taskinstance.py:3132} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='gabriel' AIRFLOW_CTX_DAG_ID='northwind_loader' AIRFLOW_CTX_TASK_ID='load_postgres' AIRFLOW_CTX_EXECUTION_DATE='2025-02-05T01:25:31.490233+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-02-05T01:25:31.490233+00:00'
[2025-02-05T01:25:32.465+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-02-05T01:25:32.503+0000] {docker.py:379} INFO - Starting docker container from image meu-meltano
[2025-02-05T01:25:32.909+0000] {docker.py:73} INFO - + set -e
[2025-02-05T01:25:32.910+0000] {docker.py:73} INFO - + cd /meltano/demo-project
[2025-02-05T01:25:32.911+0000] {docker.py:73} INFO - + echo 'Iniciando processo...'
[2025-02-05T01:25:32.911+0000] {docker.py:73} INFO - Iniciando processo...
[2025-02-05T01:25:32.912+0000] {docker.py:73} INFO - Instalando target-postgres...
[2025-02-05T01:25:32.912+0000] {docker.py:73} INFO - + echo 'Instalando target-postgres...'
[2025-02-05T01:25:32.913+0000] {docker.py:73} INFO - + meltano add loader target-postgres
[2025-02-05T01:25:34.818+0000] {docker.py:73} INFO - Added loader 'target-postgres' to your project
[2025-02-05T01:25:34.819+0000] {docker.py:73} INFO - Variant:	meltanolabs (default)
[2025-02-05T01:25:34.819+0000] {docker.py:73} INFO - Repository:	https://github.com/MeltanoLabs/target-postgres
[2025-02-05T01:25:34.819+0000] {docker.py:73} INFO - Documentation:	https://hub.meltano.com/loaders/target-postgres--meltanolabs
[2025-02-05T01:25:34.883+0000] {docker.py:73} INFO - [2m2025-02-05T01:25:34.882577Z[0m [[32m[1minfo     [0m] [1mInstalling loader 'target-postgres'[0m
[2025-02-05T01:25:49.950+0000] {docker.py:73} INFO - [2m2025-02-05T01:25:49.949494Z[0m [[32m[1minfo     [0m] [1mInstalled loader 'target-postgres'[0m
[2025-02-05T01:25:49.951+0000] {docker.py:73} INFO - 
[2025-02-05T01:25:49.951+0000] {docker.py:73} INFO - To learn more about loader 'target-postgres', visit https://hub.meltano.com/loaders/target-postgres--meltanolabs
[2025-02-05T01:25:50.918+0000] {docker.py:73} INFO - Configurando target-postgres...
[2025-02-05T01:25:50.919+0000] {docker.py:73} INFO - + echo 'Configurando target-postgres...'
[2025-02-05T01:25:50.919+0000] {docker.py:73} INFO - + meltano --environment=dev config target-postgres set host northwind_db
[2025-02-05T01:25:51.552+0000] {docker.py:73} INFO - [2m2025-02-05T01:25:51.551174Z[0m [[32m[1minfo     [0m] [1mEnvironment 'dev' is active   [0m
[2025-02-05T01:25:51.636+0000] {docker.py:73} INFO - Loader 'target-postgres' setting 'host' was set in the active environment in `meltano.yml`: 'northwind_db'
[2025-02-05T01:25:52.602+0000] {docker.py:73} INFO - + meltano --environment=dev config target-postgres set port 5432
[2025-02-05T01:25:53.246+0000] {docker.py:73} INFO - [2m2025-02-05T01:25:53.245594Z[0m [[32m[1minfo     [0m] [1mEnvironment 'dev' is active   [0m
[2025-02-05T01:25:53.326+0000] {docker.py:73} INFO - Loader 'target-postgres' setting 'port' was set in the active environment in `meltano.yml`: 5432
[2025-02-05T01:25:54.289+0000] {docker.py:73} INFO - + meltano --environment=dev config target-postgres set user northwind_user
[2025-02-05T01:25:54.916+0000] {docker.py:73} INFO - [2m2025-02-05T01:25:54.915046Z[0m [[32m[1minfo     [0m] [1mEnvironment 'dev' is active   [0m
[2025-02-05T01:25:54.997+0000] {docker.py:73} INFO - Loader 'target-postgres' setting 'user' was set in the active environment in `meltano.yml`: 'northwind_user'
[2025-02-05T01:25:55.973+0000] {docker.py:73} INFO - + meltano --environment=dev config target-postgres set password thewindisblowing
[2025-02-05T01:25:56.614+0000] {docker.py:73} INFO - [2m2025-02-05T01:25:56.613390Z[0m [[32m[1minfo     [0m] [1mEnvironment 'dev' is active   [0m
[2025-02-05T01:25:56.685+0000] {docker.py:73} INFO - Loader 'target-postgres' setting 'password' was set in `.env`: (redacted)
[2025-02-05T01:25:57.656+0000] {docker.py:73} INFO - + meltano --environment=dev config target-postgres set database northwind
[2025-02-05T01:25:58.286+0000] {docker.py:73} INFO - [2m2025-02-05T01:25:58.284912Z[0m [[32m[1minfo     [0m] [1mEnvironment 'dev' is active   [0m
[2025-02-05T01:25:58.366+0000] {docker.py:73} INFO - Loader 'target-postgres' setting 'database' was set in the active environment in `meltano.yml`: 'northwind'
[2025-02-05T01:25:59.320+0000] {docker.py:73} INFO - + meltano --environment=dev config target-postgres set default_target_schema public
[2025-02-05T01:25:59.967+0000] {docker.py:73} INFO - [2m2025-02-05T01:25:59.966029Z[0m [[32m[1minfo     [0m] [1mEnvironment 'dev' is active   [0m
[2025-02-05T01:26:00.051+0000] {docker.py:73} INFO - Loader 'target-postgres' setting 'default_target_schema' was set in the active environment in `meltano.yml`: 'public'
[2025-02-05T01:26:01.017+0000] {docker.py:73} INFO - + meltano --environment=dev config target-postgres set hard_delete true
[2025-02-05T01:26:01.649+0000] {docker.py:73} INFO - [2m2025-02-05T01:26:01.648121Z[0m [[32m[1minfo     [0m] [1mEnvironment 'dev' is active   [0m
[2025-02-05T01:26:01.737+0000] {docker.py:73} INFO - Loader 'target-postgres' setting 'hard_delete' was set in the active environment in `meltano.yml`: True
[2025-02-05T01:26:02.703+0000] {docker.py:73} INFO - + meltano --environment=dev config target-postgres set add_metadata_columns false
[2025-02-05T01:26:03.350+0000] {docker.py:73} INFO - [2m2025-02-05T01:26:03.348850Z[0m [[32m[1minfo     [0m] [1mEnvironment 'dev' is active   [0m
[2025-02-05T01:26:03.419+0000] {docker.py:73} INFO - /usr/local/lib/python3.10/site-packages/meltano/cli/interactive/config.py:403: RuntimeWarning: Unknown setting 'add_metadata_columns'
[2025-02-05T01:26:03.419+0000] {docker.py:73} INFO -   value, metadata = settings.set_with_metadata(
[2025-02-05T01:26:03.434+0000] {docker.py:73} INFO - Loader 'target-postgres' setting 'add_metadata_columns' was set in the active environment in `meltano.yml`: 'false'
[2025-02-05T01:26:04.392+0000] {docker.py:73} INFO - + meltano --environment=dev config target-postgres set schema_mapping '{
[2025-02-05T01:26:04.393+0000] {docker.py:73} INFO -             "order_details": {
[2025-02-05T01:26:04.393+0000] {docker.py:73} INFO -                 "order_id": "smallint",
[2025-02-05T01:26:04.393+0000] {docker.py:73} INFO -                 "product_id": "smallint",
[2025-02-05T01:26:04.394+0000] {docker.py:73} INFO -                 "unit_price": "real",
[2025-02-05T01:26:04.394+0000] {docker.py:73} INFO -                 "quantity": "smallint",
[2025-02-05T01:26:04.395+0000] {docker.py:73} INFO -                 "discount": "real"
[2025-02-05T01:26:04.395+0000] {docker.py:73} INFO -             }
[2025-02-05T01:26:04.395+0000] {docker.py:73} INFO -         }'
[2025-02-05T01:26:05.041+0000] {docker.py:73} INFO - [2m2025-02-05T01:26:05.039712Z[0m [[32m[1minfo     [0m] [1mEnvironment 'dev' is active   [0m
[2025-02-05T01:26:05.107+0000] {docker.py:73} INFO - /usr/local/lib/python3.10/site-packages/meltano/cli/interactive/config.py:403: RuntimeWarning: Unknown setting 'schema_mapping'
[2025-02-05T01:26:05.108+0000] {docker.py:73} INFO -   value, metadata = settings.set_with_metadata(
[2025-02-05T01:26:05.123+0000] {docker.py:73} INFO - Loader 'target-postgres' setting 'schema_mapping' was set in the active environment in `meltano.yml`: '{\n            "order_details": {\n                "order_id": "smallint",\n                "product_id": "smallint",\n                "unit_price": "real",\n                "quantity": "smallint",\n                "discount": "real"\n            }\n        }'
[2025-02-05T01:26:06.100+0000] {docker.py:73} INFO - Carregando dados para o PostgreSQL...
[2025-02-05T01:26:06.101+0000] {docker.py:73} INFO - + echo 'Carregando dados para o PostgreSQL...'
[2025-02-05T01:26:06.101+0000] {docker.py:73} INFO - + cat /meltano/demo-project/input/csv/2025-02-05/order_details.json
[2025-02-05T01:26:06.102+0000] {docker.py:73} INFO - + meltano --environment=dev invoke target-postgres
[2025-02-05T01:26:06.102+0000] {docker.py:73} INFO - + tee load_output.log
[2025-02-05T01:26:06.736+0000] {docker.py:73} INFO - [2m2025-02-05T01:26:06.734705Z[0m [[32m[1minfo     [0m] [1mEnvironment 'dev' is active   [0m
[2025-02-05T01:26:07.431+0000] {docker.py:73} INFO - 2025-02-05 01:26:07,430 | INFO     | target-postgres      | Target 'target-postgres' is listening for input from tap.
[2025-02-05T01:26:07.432+0000] {docker.py:73} INFO - 2025-02-05 01:26:07,430 | INFO     | target-postgres      | Initializing 'target-postgres' target sink...
[2025-02-05T01:26:07.432+0000] {docker.py:73} INFO - 2025-02-05 01:26:07,430 | INFO     | target-postgres.order_details | Initializing target sink for stream 'order_details'...
[2025-02-05T01:26:07.924+0000] {docker.py:73} INFO - 2025-02-05 01:26:07,922 | INFO     | target-postgres      | Target 'target-postgres' completed reading 2157 lines of input (1 schemas, 2155 records, 0 batch manifests, 1 state messages).
[2025-02-05T01:26:08.031+0000] {docker.py:73} INFO - 2025-02-05 01:26:08,029 | INFO     | target-postgres.order_details | Inserting with SQL: INSERT INTO "84a69b34_5bb9_4947_abbe_73b4e922f430" (order_id, product_id, unit_price, quantity, discount, _sdc_extracted_at, _sdc_received_at, _sdc_batched_at, _sdc_deleted_at, _sdc_sequence, _sdc_table_version, _sdc_sync_started_at) VALUES (:order_id, :product_id, :unit_price, :quantity, :discount, :_sdc_extracted_at, :_sdc_received_at, :_sdc_batched_at, :_sdc_deleted_at, :_sdc_sequence, :_sdc_table_version, :_sdc_sync_started_at)
[2025-02-05T01:26:08.241+0000] {docker.py:73} INFO - 2025-02-05 01:26:08,240 | INFO     | singer_sdk.metrics   | METRIC: {"type": "timer", "metric": "batch_processing_time", "value": 0.31178712844848633, "tags": {"stream": "order_details", "pid": 71, "status": "succeeded"}}
[2025-02-05T01:26:08.250+0000] {docker.py:73} INFO - 2025-02-05 01:26:08,249 | INFO     | target-postgres.order_details | Cleaning up order_details
[2025-02-05T01:26:08.251+0000] {docker.py:73} INFO - 2025-02-05 01:26:08,249 | INFO     | singer_sdk.metrics   | METRIC: {"type": "counter", "metric": "record_count", "value": 2155, "tags": {"stream": "order_details", "pid": 71}}
[2025-02-05T01:26:08.251+0000] {docker.py:73} INFO - 2025-02-05 01:26:08,249 | INFO     | target-postgres      | Emitting completed target state {"bookmarks": {"order_details": {}}}
[2025-02-05T01:26:08.251+0000] {docker.py:73} INFO - {"bookmarks": {"order_details": {}}}
[2025-02-05T01:26:09.331+0000] {docker.py:73} INFO - + echo 'Load completo!'
[2025-02-05T01:26:09.332+0000] {docker.py:73} INFO - Load completo!
[2025-02-05T01:26:10.037+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-02-05T01:26:10.038+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=northwind_loader, task_id=load_postgres, run_id=manual__2025-02-05T01:25:31.490233+00:00, execution_date=20250205T012531, start_date=20250205T012532, end_date=20250205T012610
[2025-02-05T01:26:10.076+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-02-05T01:26:10.090+0000] {taskinstance.py:3895} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-05T01:26:10.091+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
